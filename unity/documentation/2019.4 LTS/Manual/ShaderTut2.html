<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="教程：顶点和片元程序 - Unity 手册">
<title>教程：顶点和片元程序 - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/2019.4/uploads/Main/ShaderTutNormalsShader.jpg">
<meta name="description" content="本教程将教您如何在 Unity 着色器中编写顶点和片元程序的基础知识。有关 ShaderLab 的基本介绍，请参阅入门教程。如果要编写与光照交互的着色器，请阅读表面着色器。">
<meta property="og:description" content="本教程将教您如何在 Unity 着色器中编写顶点和片元程序的基础知识。有关 ShaderLab 的基本介绍，请参阅入门教程。如果要编写与光照交互的着色器，请阅读表面着色器。">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'ShaderTut2';
      if(!page) page = 'index';
      var version = '2019.4';
      var docs_versions = [{version: '2021.1',version_string: '2021.1',supported: true},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: true},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2019.4/Manual/ShaderTut2.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2019.4/Manual/ShaderTut2.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2019.4/Manual/ShaderTut2.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2019.4/Manual/ShaderTut2.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2019.4/Manual/ShaderTut2.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2019.4/Manual/ShaderTut2.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2019.4/Manual/ShaderTut2.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2019.4/Documentation/Manual/ShaderTut2.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ShaderTut2.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ShaderTut2.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ShaderTut2.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ShaderTut2.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ShaderTut2.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ShaderTut2.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ShaderTut2.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ShaderTut2.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ShaderTut2.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ShaderTut2.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ShaderTut2.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ShaderTut2.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ShaderTut2.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ShaderTut2.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ShaderTut2.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ShaderTut2.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ShaderTut2.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.4/Documentation/Manual/ShaderTut2.html">English</a></li>
<li><a data-lang="cn" href="/cn/2019.4/Manual/ShaderTut2.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2019.4/Manual/ShaderTut2.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.4/Manual/ShaderTut2.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.4/Manual/ShaderTut2.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2019.4/Manual/ShaderTut2.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ShaderTut2.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ShaderTut2.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ShaderTut2.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ShaderTut2.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ShaderTut2.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ShaderTut2.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ShaderTut2.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ShaderTut2.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ShaderTut2.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ShaderTut2.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ShaderTut2.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ShaderTut2.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ShaderTut2.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ShaderTut2.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ShaderTut2.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ShaderTut2.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ShaderTut2.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity 用户手册 (2019.4 LTS)</a></li>
<li><a href="Graphics.html">图形</a></li>
<li><a href="Shaders.html">网格、材质、着色器和纹理</a></li>
<li><a href="ShadersOverview.html">编写着色器</a></li>
<li><a href="SL-Reference.html">着色器参考</a></li>
<li><a href="SL-AdvancedTopics.html">高级 ShaderLab 主题</a></li>
<li>教程：顶点和片元程序</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ShaderTut1.html"></a></span><div class="tip">教程：ShaderLab 和固定函数着色器</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ParticleSystems.html"></a></span><div class="tip">粒子系统</div>
</div>
</div></div>
<h1>教程：顶点和片元程序</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>本教程将教您如何在 Unity 着色器中编写<a href="SL-ShaderPrograms.html">顶点和片元程序</a>的基础知识。有关 ShaderLab 的基本介绍，请参阅<a href="ShaderTut1.html">入门教程</a>。如果要编写与光照交互的着色器，请阅读<a href="SL-SurfaceShaders.html">表面着色器</a>。</p>

<p>让我们先简单回顾一下着色器的一般结构：</p>

<pre><code>Shader "MyShaderName"
{
    Properties
    {
        // 此处为材质属性
    }
    SubShader // 图形硬件 A 的子着色器
    {
        Pass
        {
            // 通道命令 ...
        }
        // 更多通道（如果需要）
    }
    // 更多子着色器（如果需要）
    FallBack "VertexLit" // 可选回退
}

</code></pre>

<p>最后我们介绍一个新命令：__FallBack “VertexLit”<strong>。<a href="SL-Fallback.html">Fallback</a> 命令可以在着色器的末尾使用；如果当前着色器中没有__子着色器__可以在用户的图形硬件上运行，该命令会告诉应该使用哪个着色器。效果等同于在结尾包含回退着色器中的所有子着色器。例如，如果您要编写一个花哨的法线贴图着色器，那么您可以回退到内置的 </strong>VertexLit__ 着色器，而不必为旧显卡编写一个非常基本的非法线贴图子着色器。</p>

<p><a href="ShaderTut1.html">第一个着色器教程</a>中介绍了着色器的基本构建块，同时也提供了关于<a href="SL-Properties.html">属性</a>、<a href="SL-SubShader.html">子着色器</a>和<a href="SL-Pass.html">通道</a>的完整文档。</p>

<p>构建子着色器的一种快速方法是使用在其他着色器中定义的通道。命令 <a href="SL-UsePass.html">UsePass</a> 就能执行此操作，因此您可以通过简洁的方式重用着色器代码。例如，以下命令使用内置 <strong>Specular</strong> 着色器中名为“FORWARD”的通道：
<strong>UsePass “Specular/FORWARD”</strong>。</p>

<p>要让 <strong>UsePass</strong> 运行，必须为要使用的通道提供一个名称。通道中的 <a href="SL-Name.html">Name</a> 命令将为其提供名称：__Name “MyPassName”__。</p>

<h2>顶点和片元程序</h2>

<p>我们在<a href="ShaderTut1.html">第一个教程</a>中描述了仅使用单个纹理组合指令的通道。现在演示如何在通道中使用顶点和片元程序。</p>

<p>使用顶点和片元程序（所谓的“可编程管线”）时，图形硬件中的大多数硬编码功能（“固定函数管线”）将被关闭。例如，使用顶点程序会完全关闭标准 3D 变换、光照和纹理坐标生成。同样，使用片元程序会取代将在 SetTexture 命令中定义的任何纹理组合模式；因此不需要 SetTexture 命令。</p>

<p>编写顶点/片元程序需要精通 3D 变换、光照和坐标空间，因为您必须自己重写 OpenGL等 API 中内置的固定功能。另一方面，您不仅仅可以使用内置功能！</p>

<h2>在 ShaderLab 中使用 Cg/HLSL</h2>

<p>ShaderLab 中的着色器通常是用 <a href="http://developer.nvidia.com/page/cg_main.html">Cg</a>/<a href="http://msdn.microsoft.com/en-us/library/bb509561%28VS.85%29.aspx">HLSL</a> 编程语言编写的。Cg 和 DX9 风格的 HLSL 实际上是同一种语言，所以我们将互换使用 Cg 和 HLSL（有关详细信息，请参阅<a href="SL-ShadingLanguage.html">本页</a>）。</p>

<p>着色器代码是通过在着色器文本中嵌入“Cg/HLSL 代码片段”来编写的。Unity Editor 将代码片段编译为低级着色器程序集，游戏数据文件中包含的最终着色器仅包含此低级程序集或字节码（根据平台而定）。在 __Project 视图__中选择着色器时，检视面板有一个按钮可显示已编译的着色器代码，这可以作为调试助手。Unity 自动编译所有相关平台（Direct3D 9、OpenGL、Direct3D 11、OpenGL ES 等）的 Cg 代码片段。请注意，由于 Cg/HLSL 代码是由 Editor 编译的，因此无法在运行时从脚本创建着色器。</p>

<p>通常，代码片段放在 Pass 代码块内。如下所示：</p>

<pre><code>Pass {
    // ...常规通道状态设置 ...

    CGPROGRAM
    // 此代码片段的编译指令，例如：
    #pragma vertex vert
    #pragma fragment frag

    // Cg/HLSL 代码本身

    ENDCG
    // ...通道设置的剩余部分 ...
}
</code></pre>

<p>以下示例演示了一个完整的着色器，它将对象法线渲染为彩色：</p>

<pre><code>Shader "Tutorial/Display Normals" {
    SubShader {
        Pass {

            CGPROGRAM

            #pragma vertex vert
            #pragma fragment frag
            #include "UnityCG.cginc"

            struct v2f {
                float4 pos : SV_POSITION;
                fixed3 color : COLOR0;
            };

            v2f vert (appdata_base v)
            {
                v2f o;
                o.pos = UnityObjectToClipPos(v.vertex);
                o.color = v.normal * 0.5 + 0.5;
                return o;
            }

            fixed4 frag (v2f i) : SV_Target
            {
                return fixed4 (i.color, 1);
            }
            ENDCG

        }
    }
}

</code></pre>

<p>当应用于对象时，它将生成如下图像：</p>

<figure>
<img src="../uploads/Main/ShaderTutNormalsShader.jpg" alt="">
</figure>

<p>我们的“Display Normals”着色器没有任何属性，包含一个子着色器，子着色器只有一个通道，通道中除了 Cg/HLSL 代码外无任何其他内容。让我们逐个剖析代码：</p>

<pre><code>CGPROGRAM
# pragma vertex vert
# pragma fragment frag
// ...
ENDCG
</code></pre>

<p>整个代码片段写在 <strong>CGPROGRAM</strong> 与 <strong>ENDCG</strong> 关键字之间。在开头，编译指令以 <strong>#pragma</strong> 语句形式给出：</p>

<ul>
<li>
<strong>#pragma vertex name</strong> 表示代码包含给定函数中的顶点程序（此处为 __vert__）。</li>
<li>
<strong>#pragma fragment name</strong> 表示代码包含给定函数中的片元程序（此处为 __frag__）。</li>
</ul>

<p>编译之后的指令只是普通的 Cg/HLSL 代码。我们首先包含一个<a href="SL-BuiltinIncludes.html">内置 include 文件</a>：</p>

<pre><code># include "UnityCG.cginc"
</code></pre>

<p><strong>UnityCG.cginc</strong> 文件包含常用的声明和函数，以便着色器可以保持较小（有关详细信息，请参阅<a href="SL-BuiltinIncludes.html">着色器 include 文件</a>页面）。这里我们将使用该文件中的 <strong>appdata_base</strong> 结构。我们可以直接在着色器中定义它们，当然不包括文件。</p>

<p>接下来我们定义一个“顶点到片元”结构（这里名为 __v2f__）：从顶点传递给片元程序的信息。我们将传递位置和颜色参数。颜色将在顶点程序中计算，并在片元程序中输出。</p>

<p>我们继续定义顶点程序，即 <strong>vert</strong> 函数。在这里，我们将位置和输出输入法线计算为颜色：
 o.color = v.normal * 0.5 + 0.5;</p>

<p>法线分量在 –1 到 1 范围内，而颜色在 0 到 1 范围内，因此我们在上面的代码中缩放和偏置法线。接下来我们定义一个片元程序，即 <strong>frag</strong> 函数，该函数只输出计算所得颜色，以 1 为 Alpha 分量：</p>

<pre><code>fixed4 frag (v2f i) : SV_Target
{
    return fixed4 (i.color, 1);
}
</code></pre>

<p>就是这样，我们的着色器完成了！即使这个简单的着色器对于可视化网格法线也非常有用。</p>

<p>当然，这个着色器根本不会对光源做出响应，这就是事情变得有趣的地方；有关详细信息，请参阅<a href="SL-SurfaceShaders.html">表面着色器</a>。</p>

<h2>在 Cg/HLSL 代码中使用着色器属性</h2>

<p>在着色器中定义属性时，您将为它们指定一个名称，如 <strong>_Color</strong> 或 <strong>_MainTex</strong>。要在 Cg/HLSL 中使用它们，只需定义匹配名称和类型的变量。有关详细信息，请参阅<a href="SL-PropertiesInPrograms.html">着色器程序中的属性</a>页面。</p>

<p>下面是一个完整的着色器，显示由颜色调制的纹理。当然，您也可以在纹理组合器调用中轻松进行相同操作，但这里的重点只是展示如何在 Cg 中使用属性：</p>

<pre><code>Shader "Tutorial/Textured Colored" {
    Properties {
        _Color ("Main Color", Color) = (1,1,1,0.5)
        _MainTex ("Texture", 2D) = "white" { }
    }
    SubShader {
        Pass {

        CGPROGRAM
        #pragma vertex vert
        #pragma fragment frag

        #include "UnityCG.cginc"

        fixed4 _Color;
        sampler2D _MainTex;

        struct v2f {
            float4 pos : SV_POSITION;
            float2 uv : TEXCOORD0;
        };

        float4 _MainTex_ST;

        v2f vert (appdata_base v)
        {
            v2f o;
            o.pos = UnityObjectToClipPos(v.vertex);
            o.uv = TRANSFORM_TEX (v.texcoord, _MainTex);
            return o;
        }

        fixed4 frag (v2f i) : SV_Target
        {
            fixed4 texcol = tex2D (_MainTex, i.uv);
            return texcol * _Color;
        }
        ENDCG

        }
    }
}

</code></pre>

<p>此着色器的结构与前一个示例中的相同。这里我们定义两个属性，即 <strong>_Color</strong> 和 <strong>_MainTex</strong>。在 Cg/HLSL 代码中，我们定义了相应的变量：</p>

<pre><code>fixed4 _Color;
sampler2D _MainTex;
</code></pre>

<p>有关更多信息，请参阅<a href="SL-PropertiesInPrograms.html">使用 Cg/HLSL 访问着色器属性</a>。</p>

<p>这里的顶点和片元程序没有任何花哨的东西；顶点程序使用 UnityCG.cginc 中的 <strong>TRANSFORM_TEX</strong> 宏来确保正确应用纹理比例和偏移，片元程序只是对纹理进行采样并乘以颜色属性。</p>

<h2>总结</h2>

<p>我们已经展示了如何通过几个简单的步骤编写自定义着色器程序。虽然这里显示的示例非常简单，但您可以编写复杂的任意着色器程序！这可以帮助您充分利用 Unity 并获得最佳渲染效果。</p>

<p><a href="SL-Reference.html">此处</a>是完整的 ShaderLab 参考手册，<a href="SL-VertexFragmentShaderExamples.html">顶点和片元着色器程序示例</a>页面中提供了更多示例。我们还在 <a href="http://forum.unity3d.com">forum.unity3d.com</a> 上有一个着色器论坛，请访问这个论坛以获取与着色器相关的帮助！快乐编程，享受 Unity 和 ShaderLab 的强大功能。</p>
<!-- area:graphics -->
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ShaderTut1.html"></a></span><div class="tip">教程：ShaderLab 和固定函数着色器</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ParticleSystems.html"></a></span><div class="tip">粒子系统</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">版权所有 © 2020 Unity Technologies. Publication 2019.4</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
