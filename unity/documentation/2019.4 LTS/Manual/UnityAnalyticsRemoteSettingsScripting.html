<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="Remote Settings 脚本 - Unity 手册">
<title>Remote Settings 脚本 - Unity 手册</title>
<meta name="description" content="Note: Unity Remote Config is now available as a preview package. Remote Config is an improved offering that allows you to change the behavior and appearance of your game without requiring a new binary. You can remotely enable or disable features, change the specifics of your game to target specific audiences, or run special events by scheduling new content releases.">
<meta property="og:description" content="Note: Unity Remote Config is now available as a preview package. Remote Config is an improved offering that allows you to change the behavior and appearance of your game without requiring a new binary. You can remotely enable or disable features, change the specifics of your game to target specific audiences, or run special events by scheduling new content releases.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'UnityAnalyticsRemoteSettingsScripting';
      if(!page) page = 'index';
      var version = '2019.4';
      var docs_versions = [{version: '2021.1',version_string: '2021.1',supported: true},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: true},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2019.4/Documentation/Manual/UnityAnalyticsRemoteSettingsScripting.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/UnityAnalyticsRemoteSettingsScripting.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.4/Documentation/Manual/UnityAnalyticsRemoteSettingsScripting.html">English</a></li>
<li><a data-lang="cn" href="/cn/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/UnityAnalyticsRemoteSettingsScripting.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/UnityAnalyticsRemoteSettingsScripting.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity 用户手册 (2019.4 LTS)</a></li>
<li><a href="UnityServices.html">Unity 服务</a></li>
<li><a href="UnityAnalytics.html">Unity Analytics</a></li>
<li><a href="UnityAnalyticsRemoteSettings.html">Remote Settings</a></li>
<li><a href="UnityAnalyticsRemoteSettingsUsing.html">在 Unity 项目中使用 Remote Settings</a></li>
<li>Remote Settings 脚本</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UnityAnalyticsRemoteSettingsComponent.html"></a></span><div class="tip">远程设置 (Remote Settings) 组件</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="UnityAnalyticsRemoteSettingsTesting.html"></a></span><div class="tip">测试 Remote Settings</div>
</div>
</div></div>
<h1>Remote Settings 脚本</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p><em><strong>Note</strong>: <a href="https://unity.com/remote-config">Unity Remote Config</a> is now available as a preview package. Remote Config is an improved offering that allows you to change the behavior and appearance of your game without requiring a new binary. You can remotely enable or disable features, change the specifics of your game to target specific audiences, or run special events by scheduling new content releases.</em></p>

<p>使用 Unity Scripting API <a href="../ScriptReference/RemoteSettings.html">RemoteSettings</a> 类可以在代码中访问 Remote Settings。<code>RemoteSettings</code> 类提供访问 Remote Settings 的函数（如 <code>RemoteSettings.GetString()</code>）以及在提取或更新设置时可用于触发函数的事件。</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">事件</th>
	<th style="text-align:left;">目的</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">BeforeFetchFromServer</td>
	<td style="text-align:left;">在 <code>RemoteSettings</code> 类发出网络请求以获取 Remote Settings 之前立即分发。</td>
</tr>
<tr>
	<td style="text-align:left;">Completed</td>
	<td style="text-align:left;">在网络请求完成时分发。即使网络请求失败且 Remote Settings 没有变化，也始终分发 <code>Completed</code>。可以使用传递给委托函数的 <code>serverResponse</code> 代码来确定请求是成功还是失败。该参数包含一个标准 HTTP 响应代码，例如 200 表示成功。</td>
</tr>
<tr>
	<td style="text-align:left;">Updated</td>
	<td style="text-align:left;">在网络请求成功完成后但仅在 Remote Settings 自上次检查后发生更改的情况下才分发。<br><br>注意：在 Unity 2018.1 之前，即使设置未更改，也始终分发 <code>Updated</code> 事件。如果您依赖委托函数在游戏中应用设置，无论是否有更改，都必须使用 <code>Completed</code> 事件而不是 <code>Updated</code> 事件。</td>
</tr>
</tbody>
</table>

<p>应该在应用程序启动期间尽早为这些事件注册处理程序函数，例如在第一个 Unity 场景中加载的 MonoBehaviour 的 <code>Awake()</code> 函数中进行。</p>

<p>因为获取设置需要<a href="UnityAnalyticsRemoteSettingsNetRequests.html">网络处理</a>，所以 <code>RemoteSettings</code> 对象通过异步方式分发其事件。可能不会在每个平台上甚至不会在同一平台每次启动时以相对于其他事件的相同顺序调用您的处理程序函数。请始终用合理的默认值来初始化您的配置变量，并允许在应用程序启动期间的不同时间调用事件处理程序。</p>

<p><strong>代码示例</strong></p>

<p>以下示例显示的一个类定义了可调整游戏难度的多个属性，并根据 Remote Settings 更新这些属性：</p>

<pre><code>using UnityEngine;

public class RemoteTuningVariables : MonoBehaviour {

    public float DefaultSpawnRateFactor = 1.0f;
    public float DefaultEnemySpeedFactor = 1.0f;
    public float DefaultEnemyStrengthFactor = 1.0f;
    public static float SpawnRateFactor{ get; private set; }
    public static float EnemySpeedFactor{ get; private set; }
    public static float EnemyStrengthFactor{ get; private set; }

    void Start () {
        SpawnRateFactor = DefaultSpawnRateFactor;
        EnemySpeedFactor = DefaultEnemySpeedFactor;
        EnemyStrengthFactor = DefaultEnemyStrengthFactor;

        RemoteSettings.Completed += HandleRemoteSettings;
    }

    private void HandleRemoteSettings(bool wasUpdatedFromServer, bool settingsChanged, int serverResponse){
        SpawnRateFactor 
            = RemoteSettings.GetFloat ("SpawnRateFactor", DefaultSpawnRateFactor);
        EnemySpeedFactor
            = RemoteSettings.GetFloat ("EnemySpeedFactor", DefaultEnemySpeedFactor);
        EnemyStrengthFactor 
            = RemoteSettings.GetFloat ("EnemyStrengthFactor", DefaultEnemyStrengthFactor);
    }
}
</code></pre>

<p>注意，该类在 <code>RemoteSettings.GetFloat()</code> 方法调用中提供了默认值。如果 <code>RemoteSettings</code> 对象无法找到指定的键（例如，如果您拼错键名称），该方法仍会将默认值分配给调整变量。否则，<code>GetFloat()</code> 和 <code>GetInt()</code> 方法为数字分配零，<code>GetString()</code> 为字符串分配空字符串，而 <code>GetBool()</code> 为布尔值变量分配 false。</p>

<p>该类还为 <code>Start()</code> 方法中的属性分配相同的默认值，以防另一个类在获取 Remote Settings 之前访问设置而本地没有先前缓存的配置可用。在 <code>Start()</code> 方法中分配默认值可以确保这些属性始终有合理值。</p>

<h2>确保设置一致性</h2>

<p>如果您的游戏中有多个类在不同时间访问 Remote Settings，某些对象可能会在异步网络请求完成之前访问您的设置，而另一些对象则在之后访问设置，因此可能导致设置值不一致。要避免这种不一致问题，必须等待异步网络请求完成之后才访问设置，或者直接使用当前会话开始时的现有设置。在后一种情况下，本地设置在后台更新，玩家将在下一个会话中看到它们。</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">方法</th>
	<th style="text-align:left;">优点</th>
	<th style="text-align:left;">缺点</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">等待请求完成</td>
	<td style="text-align:left;">- 设置值是一致的<br>- 始终使用最新设置</td>
	<td style="text-align:left;">- 设置可用性的延迟不确定<br>- 异步代码复杂</td>
</tr>
<tr>
	<td style="text-align:left;">使用当前设置</td>
	<td style="text-align:left;">- 设置值是一致的<br>- 设置立即可用</td>
	<td style="text-align:left;">- 在第二个会话才能使用新设置值<br>- 玩家第一次运行游戏时，没有可用的设置。（使用默认值。）</td>
</tr>
</tbody>
</table>

<p>以下示例演示了一个提供程序类，该类根据从 Analytics 服务获取的最新版 Remote Settings 来分配其属性。<code>RemoteSettings</code> 类仍然在后台更新设置，因此任何设置更改都将在下一个会话（而不是当前会话）中使用。以下示例使用单例模式，因此无论何时 <code>RemoteSettings</code> 类接收到远程更新，使用这些设置的游戏的所有部分都将获得相同的值。</p>

<pre><code>using UnityEngine;

public class RemoteSettingProvider : MonoBehaviour {
    public float DefaultSpawnRateFactor = 1.0f;
    public float DefaultEnemySpeedFactor = 1.0f;
    public float DefaultEnemyStrengthFactor = 1.0f;
    public float SpawnRateFactor{ get; private set; }
    public float EnemySpeedFactor{ get; private set; }
    public float EnemyStrengthFactor{ get; private set; }

    // 单例模式
    private static RemoteSettingProvider _instance;
    public static RemoteSettingProvider Instance
    {
        get { return _instance; }
    }

    void Awake()
    {
        if (_instance != null &amp;amp;&amp;amp; _instance != this)
        {
            Destroy(this.gameObject);
            return;
        }

        _instance = this;
        DontDestroyOnLoad(this.gameObject);

        //在远程更新之前使用当前设置，如果设置（尚）不存在，
        //则使用默认值
        SpawnRateFactor
            = RemoteSettings.GetFloat("SpawnRateFactor", DefaultSpawnRateFactor);
        EnemySpeedFactor
            = RemoteSettings.GetFloat("EnemySpeedFactor", DefaultEnemySpeedFactor);
        EnemyStrengthFactor
            = RemoteSettings.GetFloat("EnemyStrengthFactor", DefaultEnemyStrengthFactor);
    }
}
</code></pre>

<p>使用此方法时，始终在玩家安装后第一次运行游戏时使用默认设置。</p>

<p>还可以使用混合方法，此方法使用 <code>RemoteSettings.GetCount()</code> 检查是否存在本地设置。如果设置存在于本地，则可以立即使用它们，但如果没有，则添加一个事件处理程序以等待设置 <code>Updated</code> 事件：</p>

<pre><code>SpawnRateFactor
    = RemoteSettings.GetFloat("SpawnRateFactor", DefaultSpawnRateFactor);
EnemySpeedFactor
    = RemoteSettings.GetFloat("EnemySpeedFactor", DefaultEnemySpeedFactor);
EnemyStrengthFactor
    = RemoteSettings.GetFloat("EnemyStrengthFactor", DefaultEnemyStrengthFactor);


if(RemoteSettings.GetCount() == 0){
    //If there are no settings, get them from remote
    RemoteSettings.Updated += HandleRemoteSettings;
    Ready = false;
} else {
    Ready = true;
}
</code></pre>

<p>使用 Remote Settings 的其他类必须检查提供程序类的 <code>Ready</code> 属性，以确定访问设置是否安全。以下示例演示了一个等待设置并使用可配置超时值的类：</p>

<pre><code>using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class RemoteSettingConsumer : MonoBehaviour {
    public float SpeedFactor = 0;
    public float StrengthFactor = 0;
    public float SpawnRateFactor = 0;
    public float Timeout = 0.125f;

    void Start () {
        StartCoroutine(GetRemoteSettings(Time.time));
    }

    IEnumerator GetRemoteSettings(float startTime){

        while(!RemoteSettingProvider.Instance.Ready &amp;amp;&amp;amp; (Time.time - startTime) &amp;lt; Timeout)
            yield return null;

        SpeedFactor = RemoteSettingProvider.Instance.EnemySpeedFactor;
        StrengthFactor = RemoteSettingProvider.Instance.EnemyStrengthFactor;
        SpawnRateFactor = RemoteSettingProvider.Instance.SpawnRateFactor;
    }
}
</code></pre>

<p>如果在 Remote Settings 可用之前超时，则会使用默认值。使用超时值可以让游戏在正常情况下（即网络事务在非常短的时间内完成）获得最新设置，同时在网络故障的情况下通过等待请求本身超时确保了不会过度延迟启动。</p>

<hr>

<ul>
<li><span class="page-edit">2018–08–23 页面已发布</span></li>
<li><span class="page-history">2017.1 中的新功能</span></li>
<li><span class="page-history">2018–08–23 - 自 2018.1 版起，每个会话都不再分发更新的事件。</span></li>
<li><span class="page-history">截至 2018–08–23，服务与 Unity 5.5 之后的版本兼容，但是版本兼容性可能会发生变化。</span></li>
</ul>
<!-- area:monetization -->
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UnityAnalyticsRemoteSettingsComponent.html"></a></span><div class="tip">远程设置 (Remote Settings) 组件</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="UnityAnalyticsRemoteSettingsTesting.html"></a></span><div class="tip">测试 Remote Settings</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">版权所有 © 2020 Unity Technologies. Publication 2019.4</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
