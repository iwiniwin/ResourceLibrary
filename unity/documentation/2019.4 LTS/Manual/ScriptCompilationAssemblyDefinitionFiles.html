<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script> -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="程序集定义 - Unity 手册">
<title>程序集定义 - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/2019.4/uploads/Main/ScriptCompilation.png">
<meta name="description" content="通过使用程序集定义，可以将项目中的脚本组织到程序集内。在文件夹中创建一个程序集定义资源后，Unity 会从该文件夹中的所有脚本编译一个单独的托管程序集。除非子文件夹有自己的程序集定义，否则将包含子文件夹中的脚本。这些托管程序集充当 Unity 项目中的单个库。">
<meta property="og:description" content="通过使用程序集定义，可以将项目中的脚本组织到程序集内。在文件夹中创建一个程序集定义资源后，Unity 会从该文件夹中的所有脚本编译一个单独的托管程序集。除非子文件夹有自己的程序集定义，否则将包含子文件夹中的脚本。这些托管程序集充当 Unity 项目中的单个库。">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script type="text/javascript">
        function OptanonWrapper() { }
    </script><script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'ScriptCompilationAssemblyDefinitionFiles';
      if(!page) page = 'index';
      var version = '2019.4';
      var docs_versions = [{version: '2021.1',version_string: '2021.1',supported: true},{version: '2020.3',version_string: '2020.3',supported: true},{version: '2020.2',version_string: '2020.2',supported: false},{version: '2020.1',version_string: '2020.1',supported: false},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: true},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2019.4/Documentation/Manual/ScriptCompilationAssemblyDefinitionFiles.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="./index.html"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ScriptCompilationAssemblyDefinitionFiles.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.4/Documentation/Manual/ScriptCompilationAssemblyDefinitionFiles.html">English</a></li>
<li><a data-lang="cn" href="/cn/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2021.1" href="/cn/2021.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2021.1</a></li>
<li class="supported"><a class="docs_version_url_2020.3" href="/cn/2020.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.3</a></li>
<li class=""><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.2</a></li>
<li class=""><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/ScriptCompilationAssemblyDefinitionFiles.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/ScriptCompilationAssemblyDefinitionFiles.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity 用户手册 (2019.4 LTS)</a></li>
<li><a href="ScriptingSection.html">脚本</a></li>
<li><a href="ScriptingConcepts.html">脚本概述</a></li>
<li>程序集定义</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ScriptCompileOrderFolders.html"></a></span><div class="tip">特殊文件夹和脚本编译顺序</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="class-AssemblyDefinitionImporter.html"></a></span><div class="tip">程序集定义 (Assembly Definition) 属性</div>
</div>
</div></div>
<h1>程序集定义</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>通过使用程序集定义，可以将项目中的脚本组织到程序集内。在文件夹中创建一个程序集定义资源后，Unity 会从该文件夹中的所有脚本编译一个单独的托管程序集。除非子文件夹有自己的程序集定义，否则将包含子文件夹中的脚本。这些托管程序集充当 Unity 项目中的单个库。</p>

<p>程序集定义资源是文本文件，文件扩展名为 .asmdef，其中包含定义<a href="class-AssemblyDefinitionImporter.html">程序集定义 (Assembly Definition) 属性</a>的 JSON 字符串。应选择此资源文件以在 Unity Inspector 窗口中设置这些属性。还可以使用外部编辑器来直接编辑 JSON。请参阅<a href="#AsmdefFileFormat">程序集定义文件格式</a>以了解关于 JSON 语法的信息。</p>

<h2>程序集定义的优点</h2>

<p>将代码分成多个具有良好定义的依赖项的程序集时，Unity 仅在您更改脚本时重新构建依赖的程序集，因此可以减少编译时间。当项目中包括特定于平台和 Unity 版本的代码时，程序集定义还有助于管理此类项目中的依赖项。</p>

<p>如果没有程序集定义，Unity 会将项目中的所有 C# 脚本编译到某一个预定义的托管程序集内。然后，当更改任何脚本时，Unity 必须重新编译整个项目中的每个脚本。这意味着，向项目添加更多脚本时，从更改代码到看到实际变化之间的时长会更长。</p>

<p>__注意：__尽管不是必需，但只要在项目中使用程序集定义，就应该对项目中的所有代码都这样做。否则，在预定义的程序集之一中更改脚本时，Unity 仍必须重新编译项目中的所有代码，因为预定义的程序集自动依赖您使用程序集定义创建的任何程序集。</p>

<p>下图说明了如何将一个项目拆分为多个程序集：</p>

<figure>
<img src="../uploads/Main/ScriptCompilation.png" alt="预定义的程序集与手动定义的程序集">
<figcaption>预定义的程序集与手动定义的程序集</figcaption>
</figure>

<p>默认情况下，Unity 几乎将所有项目脚本都编译到 <em>Assembly-CSharp.dll</em> 托管程序集。示例中显示的一个项目被分为五个单独的程序集。<em>Main.dll</em> 程序集依赖于 <em>Stuff.dll</em> 和 <em>ThirdParty.dll</em>。<em>Stuff.dll</em> 依赖于 <em>Library.dll</em>，依此类推。因此，当 <em>Main.dll</em> 中的代码更改时，Unity 无需重新编译任何其他程序集。此外，由于 <em>Main.dll</em> 包含更少的脚本，所以它的编译速度比 <em>Assembly-CSharp.dll</em> 更快。同样，如果 <em>Stuff.dll</em> 中的代码改变，Unity 只需重新编译 <em>Main.dll</em> 和 <em>Stuff.dll</em>，而不必重新编译 <em>ThirdParty.dll</em> 或 <em>Library.dll</em>。</p>

<p>__注意：__要找出 Unity 在何处编译特定的 C# 文件，请在 Project 窗口中选择该脚本文件，然后在 Inspector 中查看 <strong>Assembly Information</strong> 列表：</p>

<figure>
<img src="../uploads/Main/sc_ScriptInspector.png" alt="Assembly-CSharp-Editor.dll 预定义程序集内的脚本">
<figcaption>Assembly-CSharp-Editor.dll 预定义程序集内的脚本</figcaption>
</figure>

<h2>程序集定义引用资源</h2>

<p>通过使用程序集定义引用资源，可以将其他文件夹添加到现有的程序集定义资源中。</p>

<h2>使用程序集定义</h2>

<p>将程序集定义资源添加到 Unity 项目中的文件夹可以定义程序集。编译后，程序集将包含文件夹及其子文件夹中的所有脚本（除非子文件夹具有自己的程序集定义）。可在 Inspector 中定义程序集的名称。</p>

<p>程序集定义是一种 Unity 资源类型。可在 Project 窗口中选择现有的程序集定义来查看或更改其属性。请参阅<a href="#AsmdefFileFormat">文件格式</a>以了解关于程序集定义资源文件格式的信息。</p>

<p>要创建程序集定义资源，请执行以下操作：</p>

<p>1.在 Project 窗口中，选择要放置程序集定义的文件夹
1.选择 <strong>Assets</strong> &gt; <strong>Create</strong> &gt; <strong>Assembly Definition</strong> 以新建程序集定义
1.选择创建的新程序集定义
1.在 Inspector 窗口中设置其属性</p>

<p>要创建程序集定义引用资源，请执行以下操作：</p>

<p>1.在 Project 窗口中，选择要将现有程序集定义资源添加到的文件夹
1.选择 <strong>Assets</strong> &gt; <strong>Create</strong> &gt; <strong>Assembly Definition Reference</strong> 以创建程序集定义引用资源
1.选择创建的新程序集定义引用
1.设置程序集定义属性，使其引用要添加其他文件夹的程序集定义资源</p>

<figure>
<img src="../uploads/Main/Asmref-Inspector.png" alt="程序集定义引用编辑器">
<figcaption>程序集定义引用编辑器</figcaption>
</figure>

<p>每个文件夹中，只能创建一个程序集定义或程序集定义引用。</p>

<p>如果在已经具有程序集定义或程序集定义引用的文件夹的子文件夹中创建程序集定义或程序集定义引用，则 Unity 会将子文件夹中的所有脚本及其子项编译到子文件夹中定义的程序集内，而不是父文件夹中定义的程序集内。</p>

<h2>Use GUID</h2>

<p>Use GUID 选项可以控制 Unity 如何序列化对程序集定义资源的引用。启用 <strong>Use GUID</strong> 后，Unity 会将这些引用另存为资源的 GUID，而不是程序集定义名称。最好的做法是使用 GUID 而不是名称，因为这意味着可以更改程序集定义资源的名称，而不必更新引用它的其他程序集定义或程序集定义引用文件。</p>

<h2>版本定义</h2>

<p>使用版本定义 (Version <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/preprocessor-directives/preprocessor-define">Defines</a>) 可以处理当前项目中不同资源和资源包之间的依赖关系。如果要通过 <a href="pack-safe.html">Package Manager 包</a>或 <a href="AssetStorePublishing.html">Asset Store 包</a>来共享项目，这会很有用。</p>

<p>要设置版本，请选择加号 (+)。可以根据需要，向程序集定义中添加任意数量的版本定义。要删除某个定义，请在列表中将其选中，然后单击减号 (-)。</p>

<p>添加版本定义时，将显示以下属性：</p>

<figure>
<img src="../uploads/Main/versiondefines.png" alt="Inspector 中的版本定义 (Version Defines)。此示例中，有两个激活的版本定义。">
<figcaption>Inspector 中的版本定义 (Version Defines)。此示例中，有两个激活的版本定义。</figcaption>
</figure>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>属性</strong></th>
	<th style="text-align:left;"><strong>描述</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>Resource</strong></td>
	<td style="text-align:left;">选择要设置定义的包或模块。该列表包含项目中所有激活的包和模块。</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Define</strong></td>
	<td style="text-align:left;">设置定义名称。仅在 <strong>Expression</strong> 返回 true 的情况下，才设置此定义。</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Expression</strong></td>
	<td style="text-align:left;">所选择的模块或包的语义版本范围。必须使用数学间隔符号。不支持通配符。此版本范围与 Microsoft 的 .NET 包管理器（即 <a href="https://docs.microsoft.com/en-us/nuget/reference/package-versioning#version-ranges-and-wildcards">NuGet</a>）相同。</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>Expression outcome</strong></td>
	<td style="text-align:left;">显示 Expression 表示的数学方程式。</td>
</tr>
</tbody>
</table>

<h2>向后兼容性和隐式依赖关系</h2>

<p>为了维持与 Unity 中的现有<a href="ScriptCompileOrderFolders.html">预定义编译系统</a>的兼容性，预定义的程序集将会引用通过程序集定义资源创建的每个程序集。这一点类似于预定义程序集引用项目中与激活的构建目标兼容的所有预编译程序集（例如插件或 .dll）。</p>

<p>下图说明了预定义的程序集、使用程序集定义资源创建的程序集以及预编译的程序集之间的默认依赖关系。</p>

<figure>
<img src="../uploads/Main/AssemblyDependencies.png" alt="程序集依赖关系">
<figcaption>程序集依赖关系</figcaption>
</figure>

<p>图中的数字表示程序集之间的引用，可以按以下方式进行控制：</p>

<p>1.默认情况下，预定义的程序集将会引用使用程序集定义资源创建的程序集。可以通过在 Inspector 中为程序集定义资源禁用 <strong>Auto Referenced</strong> 选项来禁止这种关系。请参阅<a href="class-AssemblyDefinitionImporter.html">程序集定义 (Assembly Definition) 属性</a>。
1.预定义的程序集以及使用程序集定义资源创建的程序集均自动引用预编译的程序集（插件）。要禁止此默认行为，请禁用 <strong>Plugin Inspector</strong> 中的 <strong>Auto Referenced</strong> 属性。请参阅 <a href="PluginInspector.html">Plugin Inspector</a> 以了解更多信息。
1.关闭插件的 <strong>Auto Referenced</strong> 时，可以在 Inspector 中为程序集定义资源显式引用它。为此，请启用该资源的 <strong>Override References</strong> 选项，然后添加插件的引用。请参阅<a href="class-AssemblyDefinitionImporter.html">程序集定义 (Assembly Definition) 属性</a>。</p>

<p><strong>注意：</strong>如果为预编译的程序集或使用程序集定义资源创建的程序集禁用 <strong>Auto Referenced</strong> 选项，则预编译的程序集中的类将不再能够引用或使用这些程序集中的类。无法声明预编译的程序集的显式引用。</p>

<h2>特殊文件夹</h2>

<p>Unity 对具有<a href="SpecialFolders.html">某些特殊名称</a>的文件夹中的脚本进行处理的方式不同于其他文件夹中的脚本。但是，在这些文件夹之一中或上级的一个文件夹中创建程序集定义资源时，该文件夹将失去特殊处理。在使用 Editor 文件夹时可能会注意到该变化，这些文件夹可能分散在整个项目中（取决于代码的组织方式以及所用的资源包）。</p>

<p>Unity 通常都会将名为 <em>Editor</em> 的文件夹中的所有脚本编译到预定义的 Assembly-CSharp-Editor 程序集中（无论这些脚本位于何处）。但是，如果在下级有一个 Editor 文件夹的文件夹中创建程序集定义资源，则 Unity 不再将这些 Editor 脚本放入预定义的 Editor 程序集中。实际上，这些脚本会进入通过程序集定义创建的新程序集中（脚本可能不属于该程序集）。要管理 Editor 文件夹，可以执行以下操作：</p>

<ul>
<li>将程序集定义资源添加到每个受影响的 Editor 文件夹，并设置该程序集的 <strong>Platform</strong> 属性，以便仅用于 <strong>Editor 平台</strong>。</li>
<li>将所有特定于 Editor 的代码移到程序集定义未涵盖的中心位置。</li>
</ul>

<h2>测试程序集</h2>

<p>测试程序集包含对项目中其他代码进行测试的代码。因此，不必将测试程序集包含在项目的发布版中，其他非测试程序集也不应依赖它们。如果要在 Unity 中使用测试程序集，请参阅有关<a href="https://docs.unity3d.com/Packages/com.unity.test-framework@latest/index.html?subfolder=/manual/workflow-create-test-assembly.html">如何新建测试程序集 (How to create a new test assembly)</a> 的 Test Framework 包文档。</p>

<h2>API</h2>

<p>使用 UnityEditor.Compilation 命名空间中的 <a href="../ScriptReference/Compilation.CompilationPipeline.html">CompilationPipeline</a> 类可获取 Unity 为项目构建的所有程序集（包括基于程序集定义资源创建的程序集）的相关信息。</p>

<p>例如，以下脚本使用 CompilationPipeline 来列出项目中的所有当前播放器程序集：</p>

<pre><code>using UnityEditor;
using UnityEditor.Compilation;

public static class AssemblyLister
{

    [MenuItem("Tools/List Player Assemblies in Console")]
    public static void PrintAssemblyNames()

    {
        UnityEngine.Debug.Log("== Player Assemblies ==");
        Assembly[] playerAssemblies =
            CompilationPipeline.GetAssemblies(AssembliesType.Player);

        foreach (var assembly in playerAssemblies)
        {
            UnityEngine.Debug.Log(assembly.name);
        }
    }
}
</code></pre>

<p><a name="AsmdefFileFormat"></a></p>

<h2>程序集定义文件格式</h2>

<p>程序集定义和程序集定义引用资源是 JSON 文件。可以在 Unity Editor 中编辑资源，也可以使用外部工具修改 JSON 内容。</p>

<p>程序集定义是具有以下字段的一种 JSON 对象：</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>字段</strong></th>
	<th style="text-align:left;"><strong>类型</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>name</strong></td>
	<td style="text-align:left;">string</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>references（可选）</strong></td>
	<td style="text-align:left;">字符串数组</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>includePlatforms（可选）</strong></td>
	<td style="text-align:left;">字符串数组</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>excludePlatforms（可选）</strong></td>
	<td style="text-align:left;">字符串数组</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>allowUnsafeCode（可选）</strong></td>
	<td style="text-align:left;">bool</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>autoReferenced（可选）</strong></td>
	<td style="text-align:left;">bool</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>overrideReferences（可选）</strong></td>
	<td style="text-align:left;">bool</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>precompiledReferences（可选）</strong></td>
	<td style="text-align:left;">字符串数组</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>defineConstraints（可选）</strong></td>
	<td style="text-align:left;">字符串数组</td>
</tr>
<tr>
	<td style="text-align:left;"><strong>optionalUnityReferences（可选）</strong></td>
	<td style="text-align:left;">字符串数组</td>
</tr>
</tbody>
</table>

<p>在同一程序集定义文件中，无法同时使用 <strong>includePlatforms</strong> 和 <strong>excludePlatforms</strong> 字段。</p>

<p>可以使用程序集名称或资源的 GUID 在 <strong>references</strong> 字段中指定程序集定义资源。要使用资源 GUID，该值应该采用 <em>GUID:Asset GUID</em> 格式，例如，<em>“GUID:0ec2b662ccc592241854c1b507df8a89”</em>。
可使用 <a href="../ScriptReference/AssetDatabase.AssetPathToGUID.html">AssetDatabase.AssetPathToGUID</a> 来获取资源的 GUID。</p>

<p>可以使用 <a href="../ScriptReference/Compilation.CompilationPipeline.GetAssemblyDefinitionPlatforms.html">CompilationPipeline.GetAssemblyDefinitionPlatforms()</a> 函数来获取平台名称字符串。（必须为当前的 Editor 安装对平台的支持。）</p>

<p>程序集定义引用是具有以下字段的一种 JSON 对象：</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>字段</strong></th>
	<th style="text-align:left;"><strong>类型</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><strong>reference</strong></td>
	<td style="text-align:left;">string</td>
</tr>
</tbody>
</table>

<p>可以使用程序集名称或资源的 GUID 来指定引用的程序集定义资源。要使用资源 GUID，该值应该采用 GUID:Asset GUID 格式，例如，“GUID:0ec2b662ccc592241854c1b507df8a89”。AssetDatabase.AssetPathToGUID can be used to retrieve the GUID of an asset.</p>

<h3>程序集定义 JSON 示例</h3>

<p>MyLibrary.asmdef</p>

<pre><code>{
    "name": "MyLibrary",
    "references": [ "Utility" ],
    "includePlatforms": ["Android", "iOS"]
}
</code></pre>

<p>MyLibrary2.asmdef</p>

<pre><code>{
    "name": "MyLibrary2",
    "references": [ "GUID:0ec2b662ccc592241854c1b507df8a89" ],
     "excludePlatforms": ["WebGL"]
}
</code></pre>
<!-- area:core -->
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="ScriptCompileOrderFolders.html"></a></span><div class="tip">特殊文件夹和脚本编译顺序</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="class-AssemblyDefinitionImporter.html"></a></span><div class="tip">程序集定义 (Assembly Definition) 属性</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">版权所有 © 2020 Unity Technologies. Publication 2019.4</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
